# 实时聊天应用

这是一个使用Socket.io实现实时通信的聊天应用，支持群聊和私聊功能。用户可以在不同浏览器、不同设备之间进行实时聊天，消息会立即同步到所有在线用户。

## 功能特点

- ✅ 实时消息发送和接收
- ✅ 多用户支持，跨浏览器/设备通信
- ✅ 实时在线用户列表显示
- ✅ 群聊和私聊功能
- ✅ 响应式设计，适配各种设备
- ✅ 用户友好的界面，包含动画效果
- ✅ 支持设置和更换昵称
- ✅ 消息按时间顺序显示并区分发送者
- ✅ Shift+Enter换行支持
- ✅ 连接状态指示器
- ✅ 消息已读状态标记

## 技术栈

- **前端**: HTML5, CSS3, JavaScript (ES6+)
- **后端**: Node.js, Express
- **实时通信**: Socket.io
- **样式**: 纯CSS实现，无需外部框架

## 安装和配置

### 安装依赖

```bash
npm install
```

### 运行服务器

```bash
npm start
```

或者使用开发模式（自动重启）：

```bash
npm run dev
```

服务器将在 http://localhost:3000 启动

### 客户端配置

客户端代码已经配置为自动连接到服务器。如果需要更改服务器地址，请修改 `public/js/app.js` 中的相关配置。

## 如何使用

1. **启动服务器**：按照上述安装和配置步骤启动服务器

2. **访问应用**：
   - 在浏览器中访问 http://localhost:3000
   - 首次使用时，需要设置一个昵称
   - 开始聊天！

3. **测试实时功能**：
   - 在多个浏览器标签页或多个设备上打开应用
   - 使用不同的昵称登录
   - 发送消息，观察消息如何实时同步到所有窗口

4. **使用私聊功能**：
   - 在顶部的聊天模式选择器中选择"私聊"
   - 从下拉列表中选择要私聊的用户
   - 开始与选定用户的私密聊天

## 功能使用说明

- **设置昵称**：首次打开应用时会提示设置昵称，或点击顶部的"更换昵称"按钮
- **切换聊天模式**：使用顶部的下拉菜单在群聊和私聊模式之间切换
- **选择私聊对象**：在私聊模式下，从下拉列表中选择要聊天的用户
- **发送消息**：在底部输入框中输入消息，按Enter键发送
- **多行消息**：按住Shift+Enter可以在输入框中插入换行
- **查看在线用户**：右侧边栏显示当前在线的用户列表
- **查看连接状态**：右下角的状态指示器显示当前连接状态
- **清除本地记录**：点击"清除本地记录"按钮可以清空当前页面的聊天记录（不影响其他用户）

## 项目结构

```
chat/
├── public/                  # 公共资源文件
│   ├── css/                 # CSS样式文件
│   │   └── style.css        # 主样式文件
│   ├── js/                  # JavaScript文件
│   │   └── app.js           # 主要JavaScript代码，包含Socket.io客户端集成
│   └── index.html           # 主HTML页面
├── server/                  # 后端服务器
│   └── server.js            # Express和Socket.io服务器代码
├── package.json             # 项目配置和依赖
└── README.md                # 项目说明文档
```

## 技术实现细节

### 实时消息机制

- 使用Socket.io实现实时双向通信
- 支持群聊消息广播和私聊消息定向发送
- 消息按时间戳排序，确保显示顺序正确
- 本地缓存私聊消息历史

### 用户在线状态

- 使用Socket.io的连接和断开事件跟踪用户在线状态
- 用户列表实时更新，显示当前在线用户
- 支持用户加入和离开的系统通知

### 错误处理

- 连接状态实时监控和显示
- 网络问题时自动尝试重连
- 发送失败时提供用户反馈

## 注意事项

1. **隐私与安全**：
   - 当前实现使用昵称作为身份标识，没有密码验证
   - 私聊消息仅发送给特定用户，但服务器可以访问所有消息
   - 在生产环境中，建议添加用户认证和授权机制

2. **数据保留**：
   - 消息只在会话期间保留在内存中
   - 服务器重启后，消息历史将丢失
   - 私聊消息缓存在客户端本地存储中

3. **部署考虑**：
   - 生产环境部署时，建议配置适当的安全设置
   - 考虑使用负载均衡以支持大量并发连接

## 故障排除

1. **无法连接到服务器**：
   - 确保服务器已启动并运行
   - 检查网络连接
   - 刷新页面尝试重新连接
   - 查看浏览器控制台的错误信息

2. **消息不同步**：
   - 确认所有用户已连接到同一服务器
   - 检查Socket.io连接状态指示器

3. **用户列表不更新**：
   - 用户列表实时更新，无需等待
   - 检查是否有其他用户在线

## 浏览器兼容性

支持所有现代浏览器：
- Chrome (最新版本)
- Firefox (最新版本)
- Safari (最新版本)
- Edge (最新版本)

## 许可证

本项目仅供学习和演示使用。
